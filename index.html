<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <title>🤖 Clawdia Trading Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
    <link rel="stylesheet" href="styles.css?v=20260217a">
</head>
<body>
    <div class="container">
        <header>
            <h1>🤖 Clawdia Trading Dashboard</h1>
            <div class="status-indicator" id="status-indicator">
                <span class="status-dot"></span>
                <span id="status-text">データ読み込み中...</span>
            </div>
        </header>

        <!-- タブナビゲーション -->
        <nav class="tab-nav">
            <div class="tab-container">
                <button class="tab-btn active" data-tab="overview">📊 概要</button>
                <button class="tab-btn" data-tab="tasks">📋 タスク</button>
                <button class="tab-btn" data-tab="trades">💹 トレード</button>
                <button class="tab-btn" data-tab="signals">📈 シグナル</button>
                <button class="tab-btn" data-tab="strategies">🎯 戦略</button>
                <button class="tab-btn" data-tab="meme">🐸 ミーム</button>
                <button class="tab-btn" data-tab="simulation">🧪 検証</button>
                <button class="tab-btn" data-tab="reports">📝 日報</button>
                <button class="tab-btn" data-tab="memories">🧠 メモリ</button>
                <button class="tab-btn" data-tab="creative">🎨 Creative</button>
            </div>
        </nav>

        <!-- タブコンテンツ -->
        <div class="tab-content">
            <!-- 概要タブ -->
            <div id="tab-overview" class="tab-panel active">
                <!-- 総資産ヘッダー -->
                <section class="card total-assets-card">
                    <div class="total-assets-header">
                        <div class="total-assets-value" id="total-balance">$0.00</div>
                        <div class="total-assets-change" id="total-change">
                            <span class="change-amount" id="change-amount">--</span>
                            <span class="change-percent" id="change-percent">--</span>
                        </div>
                        <div class="total-assets-label">総資産 (USD)</div>
                    </div>
                    <div class="last-updated" id="last-updated">最終更新: -</div>
                </section>

                <!-- ポートフォリオ円グラフ + 内訳 -->
                <section class="card">
                    <h2>📊 ポートフォリオ構成</h2>
                    <div class="portfolio-layout">
                        <div class="portfolio-chart-wrap">
                            <canvas id="portfolioChart"></canvas>
                        </div>
                        <div class="portfolio-breakdown" id="portfolio-breakdown">
                            <!-- JS で生成 -->
                        </div>
                    </div>
                </section>

                <!-- 資産推移チャート -->
                <section class="card">
                    <h2>📈 資産推移</h2>
                    <div class="chart-container">
                        <canvas id="portfolioHistoryChart"></canvas>
                    </div>
                </section>

                <!-- 損益サマリー -->
                <section class="card">
                    <h2>📈 トレード実績</h2>
                    <div class="pnl-grid">
                        <div class="pnl-item">
                            <div class="value" id="total-trades">0</div>
                            <div class="label">総トレード数</div>
                        </div>
                        <div class="pnl-item">
                            <div class="value" id="successful-trades">0</div>
                            <div class="label">勝ち/決済数</div>
                        </div>
                        <div class="pnl-item">
                            <div class="value" id="success-rate">0%</div>
                            <div class="label">勝率</div>
                        </div>
                        <div class="pnl-item">
                            <div class="value" id="total-fees">$0.00</div>
                            <div class="label">総手数料</div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- タスクタブ -->
            <div id="tab-tasks" class="tab-panel">
                <section class="card">
                    <h2>📋 タスク管理</h2>
                    
                    <!-- タスク統計 -->
                    <div class="task-stats">
                        <div class="stat-item hikarimaru-special" onclick="filterHikarimaruPending()" style="cursor:pointer">
                            <div class="value" id="tasks-hikarimaru-pending">0</div>
                            <div class="label">👑 確認待ち</div>
                        </div>
                        <div class="stat-item">
                            <div class="value" id="tasks-in-progress">0</div>
                            <div class="label">進行中</div>
                        </div>
                        <div class="stat-item">
                            <div class="value" id="tasks-today-completed">0</div>
                            <div class="label">今日完了</div>
                        </div>
                    </div>

                    <!-- タスクフィルター -->
                    <div class="task-filters">
                        <select id="task-status-filter" class="filter-select">
                            <option value="">全ステータス</option>
                            <option value="pending">未着手</option>
                            <option value="in_progress">進行中</option>
                            <option value="completed">完了</option>
                            <option value="blocked">ブロック</option>
                        </select>
                        <select id="task-assignee-filter" class="filter-select">
                            <option value="">全担当者</option>
                            <option value="hikarimaru">👑 Hikarimaru</option>
                            <option value="clawdia">🩶 Clawdia</option>
                            <option value="talon">🦅 Talon</option>
                            <option value="velvet">🌙 Velvet</option>
                        </select>
                        <button onclick="resetTaskFilters()" class="btn btn-secondary">リセット</button>
                    </div>

                    <!-- タスク一覧 -->
                    <div id="tasks-container">
                        <div class="loading">データ読み込み中...</div>
                    </div>
                </section>
            </div>

            <!-- トレードタブ -->
            <div id="tab-trades" class="tab-panel">
                <!-- フィルター -->
                <section class="card">
                    <div class="trade-filters">
                        <select id="trade-strategy-filter" class="filter-select" onchange="applyTradeFilters()">
                            <option value="">全戦略</option>
                            <option value="CCI">CCI</option>
                            <option value="GRID">GRID</option>
                            <option value="BOLLINGER">BOLLINGER</option>
                        </select>
                        <select id="trade-symbol-filter" class="filter-select" onchange="applyTradeFilters()">
                            <option value="">全銘柄</option>
                            <option value="WBTC">WBTC</option>
                            <option value="BNB">BNB</option>
                            <option value="SOL">SOL</option>
                        </select>
                        <select id="trade-direction-filter" class="filter-select" onchange="applyTradeFilters()">
                            <option value="">全方向</option>
                            <option value="buy">買いのみ</option>
                            <option value="sell">売りのみ</option>
                        </select>
                        <label class="filter-checkbox"><input type="checkbox" id="trade-hide-test" checked onchange="applyTradeFilters()"> テスト非表示</label>
                        <button onclick="resetTradeFilters()" class="btn btn-secondary">リセット</button>
                    </div>
                    <div id="cumulative-pnl" class="cumulative-pnl"></div>
                </section>

                <!-- オープンポジション -->
                <section class="card" id="open-positions-section">
                    <h2>🔥 保有中ポジション</h2>
                    <div id="open-positions-container">
                        <div class="loading">データ読み込み中...</div>
                    </div>
                </section>

                <!-- 完了済みトレード -->
                <section class="card">
                    <h2>✅ 完了済みトレード（往復確定）</h2>
                    <div id="completed-trades-container">
                        <div class="loading">データ読み込み中...</div>
                    </div>
                </section>

                <!-- 全履歴 -->
                <section class="card">
                    <h2>📜 全トレード履歴</h2>
                    <div class="trade-table-container">
                        <table class="trade-table" id="trade-table">
                            <thead>
                                <tr>
                                    <th>日時</th>
                                    <th>方向</th>
                                    <th>数量</th>
                                    <th>USD換算</th>
                                    <th>状態</th>
                                </tr>
                            </thead>
                            <tbody id="trade-table-body">
                                <tr><td colspan="5" class="loading">データ読み込み中...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>

            <!-- シグナルタブ -->
            <div id="tab-signals" class="tab-panel">
                <!-- 最新シグナルサマリー -->
                <section class="card">
                    <h2>🎯 現在のマーケット状況</h2>
                    <div id="signal-summary">
                        <div class="loading">データ読み込み中...</div>
                    </div>
                </section>

                <!-- CCI推移チャート -->
                <section class="card">
                    <h2>📡 CCI推移</h2>
                    <div class="chart-controls">
                        <button id="chart-1d" class="chart-btn active">1日</button>
                        <button id="chart-7d" class="chart-btn">7日</button>
                        <button id="chart-30d" class="chart-btn">30日</button>
                    </div>
                    <div class="chart-container">
                        <canvas id="signalChart"></canvas>
                    </div>
                    <div class="signal-legend">
                        <div class="legend-item"><span class="legend-dot" style="background:#ff4444"></span> CCI &lt; -100: 買いシグナル発生ゾーン</div>
                        <div class="legend-item"><span class="legend-dot" style="background:#00ff88"></span> CCI &gt; 100: 売り圧力ゾーン</div>
                        <div class="legend-item"><span class="legend-dot" style="background:#888"></span> -100〜100: 中立</div>
                    </div>
                </section>
            </div>

            <!-- ミームタブ -->
            <div id="tab-meme" class="tab-panel">
                <section class="card">
                    <h2>🐸 ミームコインスキャナー</h2>
                    <p class="subtitle">急騰検出・安全性チェック・テストトレード結果</p>
                    <div id="meme-scanner-status" class="meme-section">
                        <h3>📡 スキャナー状態</h3>
                        <div id="meme-tracking-list" class="loading">データ読み込み中...</div>
                    </div>
                </section>
                <section class="card">
                    <h3>🧪 リスク調査結果</h3>
                    <div id="meme-survey-results" class="loading">データ読み込み中...</div>
                </section>
                <section class="card">
                    <h3>💹 ミームトレード履歴</h3>
                    <div id="meme-pnl-summary"></div>
                    <div id="meme-trades-container">
                        <table class="trade-table" id="meme-trade-table">
                            <thead>
                                <tr>
                                    <th>時刻</th>
                                    <th>トークン</th>
                                    <th>方向</th>
                                    <th>金額</th>
                                    <th>RT cost</th>
                                    <th>ステータス</th>
                                </tr>
                            </thead>
                            <tbody id="meme-trade-body"></tbody>
                        </table>
                    </div>
                </section>
            </div>

            <!-- 検証タブ -->
            <div id="tab-simulation" class="tab-panel">
                <section class="card">
                    <h2>🧪 仮想取引シミュレーション</h2>
                    <p class="subtitle">複数パラメータを同時比較 — リアルタイムペーパートレード</p>
                    <div id="sim-status" class="meme-section"></div>
                </section>
                <section class="card">
                    <h3>📊 パラメータ比較</h3>
                    <div id="sim-param-table-container">
                        <table class="trade-table" id="sim-param-table">
                            <thead>
                                <tr>
                                    <th>セット名</th>
                                    <th>ACT%</th>
                                    <th>TRAIL%</th>
                                    <th>トレード数</th>
                                    <th>勝率</th>
                                    <th>平均P&L%</th>
                                    <th>累計P&L$</th>
                                    <th>最高</th>
                                    <th>最低</th>
                                    <th>SL/TRAIL/TO</th>
                                </tr>
                            </thead>
                            <tbody id="sim-param-body"></tbody>
                        </table>
                    </div>
                </section>
                <section class="card">
                    <h3>📈 オープンポジション</h3>
                    <div id="sim-open-container">
                        <table class="trade-table" id="sim-open-table">
                            <thead>
                                <tr>
                                    <th>トークン</th>
                                    <th>エントリー</th>
                                    <th>現在P&L%</th>
                                    <th>ピーク%</th>
                                    <th>スコア</th>
                                    <th>データ点数</th>
                                    <th>アクティブ</th>
                                </tr>
                            </thead>
                            <tbody id="sim-open-body"></tbody>
                        </table>
                    </div>
                </section>
                <section class="card">
                    <h3>📜 最近の完了トレード</h3>
                    <div id="sim-recent-container">
                        <table class="trade-table" id="sim-recent-table">
                            <thead>
                                <tr>
                                    <th>トークン</th>
                                    <th>時刻</th>
                                    <th>ピーク%</th>
                                    <th>conservative</th>
                                    <th>current</th>
                                    <th>tight</th>
                                    <th>aggressive</th>
                                </tr>
                            </thead>
                            <tbody id="sim-recent-body"></tbody>
                        </table>
                    </div>
                </section>
            </div>

            <!-- 戦略タブ -->
            <div id="tab-strategies" class="tab-panel">
                <section class="card">
                    <h2>🎯 ポートフォリオ戦略一覧</h2>
                    <p class="subtitle">各銘柄のライブ取引ロジックとパラメータ</p>
                    <div id="strategies-container">
                        <div class="loading">データ読み込み中...</div>
                    </div>
                </section>
            </div>

            <!-- 日報タブ -->
            <div id="tab-reports" class="tab-panel">
                <section class="card">
                    <h2>📝 日報</h2>
                    <div id="daily-reports-container">
                        <div class="loading">データ読み込み中...</div>
                    </div>
                </section>
            </div>

            <!-- メモリタブ -->
            <div id="tab-memories" class="tab-panel">
                <section class="card">
                    <h2>🧠 エージェントメモリ</h2>
                    <div class="memory-agent-tabs">
                        <button class="memory-tab-btn active" data-agent="clawdia">🩶 Clawdia</button>
                        <button class="memory-tab-btn" data-agent="talon">🦅 Talon</button>
                        <button class="memory-tab-btn" data-agent="velvet">🌙 Velvet</button>
                    </div>
                    <div class="memory-file-tabs" id="memory-file-tabs"></div>
                    <div id="memory-content" class="memory-content">
                        <div class="loading">データ読み込み中...</div>
                    </div>
                </section>
            </div>
            <!-- Creativeタブ -->
            <div id="tab-creative" class="tab-panel">
                <section class="card">
                    <h2>🎨 Gallery</h2>
                    <p class="subtitle">ディアが描いたもの</p>
                    <div id="creative-gallery" class="creative-gallery">
                        <div class="loading">データ読み込み中...</div>
                    </div>
                </section>
                <section class="card">
                    <h2>✏️ Essays</h2>
                    <div id="creative-essays">
                        <div class="loading">データ読み込み中...</div>
                    </div>
                </section>
                <section class="card">
                    <h2>📓 Diary</h2>
                    <div id="creative-diary">
                        <div class="loading">データ読み込み中...</div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <script src="dashboard.js?v=20260220a"></script>
</body>
</html>
